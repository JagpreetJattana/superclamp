/*!
 * Superclamp 0.1.2
 * https://github.com/makandra/superclamp
 */
(function(){var t,e,n,i,o,r,s,u,l,a,c,p,h,m,d,f,g,_,y,v,A,$,N,T,b,w,E,B,F=function(t,e){return function(){return t.apply(e,arguments)}},V=[].slice;a=!1,n=!1,r="superclamp:done",p="superclamp:update",l="superclamp:instance",c="superclamp-ready",i="superclamp:dimensions",o="superclamp:distanceToBottomRight",s="superclamp:fragmentNodes",u="superclamp:fragmentValues",e=".clamp-ellipsis.is-not-required {\n  visibility: hidden !important;\n}\n.clamp-hidden {\n  display: none !important;\n}",t=window.jQuery,t("<style type='text/css'>"+e+"</style>").appendTo(document.head),t.fn.clamp=function(){return this.each(function(){return Superclamp.clamp(this)}),d(),this},t(function(){return t(document).on(p,Superclamp.reclampAll)}),this.Superclamp=function(){function e(e){var n;this.$element=e,this._clampNode=F(this._clampNode,this),this._checkFit=F(this._checkFit,this),this._unchanged=F(this._unchanged,this),this._distanceToBottomRight=F(this._distanceToBottomRight,this),this._getEllipsisAt=F(this._getEllipsisAt,this),this._clampThis=F(this._clampThis,this),this._storeDistance=F(this._storeDistance,this),this._updateElementAt=F(this._updateElementAt,this),h("initialize",this.$element),n=document.createTextNode(" "),this.$ellipsis=t('<span class="clamp-ellipsis">\u2026</span>'),this.$element.append(n,this.$ellipsis),B(this.$ellipsis),this.$element.data(l,this),this.$element.attr(c,!0)}return e.clamp=function(n){var i,o;return h(".clamp",n),i=t(n),o=i.data(l)||new e(i),o.clamp()},e.reclampAll=function(n){var i,o,r,s;for(null==n&&(n=document),s=t(n).find("["+c+"]"),o=0,r=s.length;r>o;o++)i=s[o],e.clamp(i);return d()},e.prototype.clamp=function(){return b("query",function(t){return function(){return t._updateElementAt(),t._unchanged()?h("unchanged",t.$element):t._clampThis()}}(this))},e.prototype._updateElementAt=function(){return this.elementAt=y(this.$element)},e.prototype._storeDistance=function(){var t;return t=this._distanceToBottomRight(),h("storing distance",t),this.$ellipsis.data(o,t)},e.prototype._clampThis=function(){return T("_clampThis",this.$element),this._clampNode(this.$element.get(0),function(t){return function(e){return t._storeDistance(),b("layout",function(){return t.$ellipsis.toggleClass("is-not-required",e),t.$element.trigger(r)})}}(this))},e.prototype._getEllipsisAt=function(){return v(this.$ellipsis)},e.prototype._distanceToBottomRight=function(){var t;return t=this._getEllipsisAt(),[this.elementAt.right-t.right,this.elementAt.bottom-t.bottom]},e.prototype._unchanged=function(){var t,e,n,i,r,s;return s=this.$ellipsis.data(o),null!=s?(t=s[0],n=s[1],r=this._distanceToBottomRight(),e=r[0],i=r[1],h("_unchanged: %o == %o && %o == %o",t,e,n,i),t===e&&n===i):!1},e.prototype._checkFit=function(t){return b("query",function(e){return function(){var n,i;return i=e._getEllipsisAt(),n=i.bottom<=e.elementAt.bottom&&i.right<=e.elementAt.right,h("checkFit: %o (bottom: %o <= %o, right: %o <= %o)",n,i.bottom,e.elementAt.bottom,i.right,e.elementAt.right),t(n)}}(this))},e.prototype._clampNode=function(e,n,i){var o,r;return null==i&&(i=!0),o=function(t){return function(i,s,u){return b("query",function(){var l,a,c;return h("findBestFit #contents: %o, nodeName: %o, prefix: %o",i,e.nodeName,s),0===i.length?n(u):1===i.length?r?(e.nodeValue=s+i[0],t._checkFit(function(t){return b("layout",function(i){return function(){return t?n(u):(e.nodeValue=s.replace(/ $/,""),n(!1))}}(this))})):t._clampNode(i[0],n,u):(a=Math.floor(i.length/2),l=i.slice(0,a),c=i.slice(a),h("findBestFit head: %o, tail: %o",l,c),r?e.nodeValue=s+l.join(" "):(E(l),A(c)),t._checkFit(function(t){return b("layout",function(n){return function(){return t?(h("fits"),r?o(c,e.nodeValue+" ",u):o(c,"",u)):(h("wont fit"),o(l,s,!1))}}(this))}))})}}(this),r="#text"===e.nodeName,b("layout",function(n){return function(){var s,u;return r?($(e),o(_(e),"",i)):"#comment"!==e.nodeName?(s=t(e),E([s]),u=f(s),s.is(n.$element)&&(u=u.slice(0,-2)),o(u,"",i)):void 0}}(this))},e}(),N={layout:[],query:[]},b=function(t,e){return N[t].push(e)},m=function(t){var e,n;if(n=N[t],0===n.length)return!0;for(h("draining",t);e=n.shift();)e();return!1},d=function(){var t,e,n;for(n=[];!t||!e;)t=m("layout"),n.push(e=m("query"));return n},h=function(){var t,e;return t=1<=arguments.length?V.call(arguments,0):[],n&&null!=(e=window.console)&&"function"==typeof e.debug?e.debug.apply(e,t):void 0},T=function(){var t,e;return t=1<=arguments.length?V.call(arguments,0):[],a&&null!=(e=window.console)&&"function"==typeof e.log?e.log.apply(e,t):void 0},B=function(t){var e,n;return e=t.height(),n=t.width(),t.data(i,[n,e]),h("storeDimensions",n,e)},v=function(t){var e,n,o,r;return o=t.data(i)||[t.width(),t.height()],r=o[0],e=o[1],n={top:t.prop("offsetTop"),left:t.prop("offsetLeft")},null==n.bottom&&(n.bottom=n.top+e),null==n.right&&(n.right=n.left+r),h("getPosition of %o: %o",t,n),n},y=function(t){var e;return e={top:t.prop("offsetTop"),left:t.prop("offsetLeft")},e.top+=parseInt(t.css("padding-top")),e.left+=parseInt(t.css("padding-left")),e.bottom=e.top+t.height(),e.right=e.left+t.width(),e},g=function(e){var n,i,o,r;return n=t(e.parentNode),o=n.data(s)||[],r=n.data(u)||[],i=t.inArray(e,o),[o,r,i,n]},w=function(t,e){var n,i,o,r,l;return r=g(t),o=r[0],l=r[1],i=r[2],n=r[3],0>i&&(i=o.length),o[i]=t,l[i]=e,n.data(s,o),n.data(u,l),e},_=function(t){var e,n,i,o,r;return o=g(t),i=o[0],r=o[1],n=o[2],e=o[3],r[n]},$=function(t){return null==_(t)&&w(t,t.nodeValue.split(/\s+/)),t},f=function(e){return t.makeArray(e.get(0).childNodes)},A=function(e){var n,i,o,r;for(r=[],n=0,i=e.length;i>n;n++)o=e[n],"#text"===o.nodeName?($(o),r.push(o.nodeValue="")):r.push(t(o).addClass("clamp-hidden"));return r},E=function(e){var n,i,o,r,s;for(s=[],i=0,o=e.length;o>i;i++)r=e[i],"#text"===r.nodeName?($(r),s.push(r.nodeValue=_(r).join(" "))):(n=t(r),n.removeClass("clamp-hidden"),s.push(E(f(n))));return s}}).call(this);